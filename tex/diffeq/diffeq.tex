\chapter{Ordinary Differential Equations}
\section{Separable Differential Equations}

\begin{example}
    Find $y$ for the following differential equation:
    $$\frac{dy}{dx} = x.$$
\end{example}
\begin{soln}
    We see that $dy = x ~ dx$. Taking the integral of both sides, we obtain
    $$y = \frac{1}{2} x^2 + C.$$
\end{soln}

\begin{example}
    Find $y$ for the following differential equation:
    $$\frac{dy}{dx} = \frac{1}{x}.$$
\end{example}
\begin{soln}
    We see that $dy = \frac{1}{x} ~ dx$. Taking the integral of both sides,
    we obtain $$y = \ln|x| + C.$$
\end{soln}
\begin{example}
    Find $y$ for the following differential equation:
    $$\frac{dy}{dx} = \cos x.$$
\end{example}
\begin{soln}
    We see that $dy = \cos x ~ dx$. Taking the integral of both sides, we obtain
    $$\boxed{y = \sin x + C}.$$
\end{soln}
\begin{example}
    Find $y$ for the following differential equation:
    $$\frac{dy}{dx} = e^x.$$
\end{example}
\begin{soln}
    We see that $dy = e^x ~ dx$. Taking the integral of borth sides, we obtain
    $$\boxed{y =  e^x + C}.$$
\end{soln}
\begin{example}
    Find $y$ for the following differential equation: 
    $$\frac{dy}{dx} = xy.$$
\end{example}
\begin{soln}
    We see that $\frac{1}{y} ~ dy  = x ~ dx$. Taking the integral of
    both sides, we get
    $$\ln |y| = \frac{1}{2}x^2 + C \implies y = e^{\frac{1}{2}x^2+C}.$$
\end{soln}
\begin{example}
    Find $y$ for the following differential equation:
    $$\frac{dy}{dx} = x^2y-2xy.$$
\end{example}
\begin{soln}
    We see that $dy = xy(x-2) ~ dx \implies \frac{1}{y} ~dy= x^2-2x ~ dx$.
    Taking the integral of both sides we get that
    $$\ln |y| = \frac{1}{3}x^3-x^2 + C \implies y = e^{\frac{1}{3}x^3-x^2 + C}.$$
\end{soln}
\begin{example}
    Find $y$ for the following differential equation:
    $$(x^2+x)~\frac{dy}{dx} = y-1.$$
\end{example}
\begin{soln}
    We see that $\frac{1}{y-1} ~ dy = \frac{1}{x^2+x} ~ dx$. Taking the
    integral of both sides, we find that
    $$\ln|y-1| = \ln|x|-\ln|x+1| +C\implies y = C\left|\frac{x}{x+1}\right|+1.$$
\end{soln}
\begin{example}
    Find $y$ for the following differential equation:
    $$\frac{dy}{dx} = x^2y-2xy,$$
    where $y(0) = e$.
\end{example}
\begin{soln}
    By a previous example we have $$y = C\left(e^{\frac{1}{3}x^3-x^2}\right).$$
    By the initial value, we solve for $C$ to get $C = e$. Therefore,
    $$\boxed{y = e^{\frac{1}{3}x^3-x^2+1}}.$$
\end{soln}

\section{ODEs and PDEs}
\begin{example}[ODE]
    $$\frac{d^2f}{dx^2} + 3 \frac{df}{dx} + 5 = 0  \implies y''+3y'+5=0.$$
\end{example}
The general from of a linear ODE is
$$a_ny^{(n)} +a_{n-1}y^{(n-1)}+\cdots+a_1y'+a_0y = f(x),$$
where $a_i \in \RR$ such that $i \in \{0, 1, \dots, n\}$.
\begin{example}[PDE]
    $$\frac{\partial^2f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2} = 0.$$
\end{example}
The order of a differential equation is the highest derivative in the equation.

For first order ODEs, we try separation of variables first.

\begin{definition}
    A \alert{homogeneous} ordinary differential equation is one with $f(x) = 0$ 
    with constant coefficients.
\end{definition}
\begin{example}[Homogeneous ODE]
    $$y''+7y'+12y=0.$$
\end{example}
Functions of the form $y=e^{mx}$ are an "educated guess" for solving ODEs.
\begin{soln}
    Let $y=e^{mx}$. This implies $y'=me^{mx}$ and $y'' = m^2e^{mx}$.
    Plugging in, we get
    \begin{align*}
        m^2e^{mx}+7me^{mx}+12e^{mx}&=0 \\
        e^{mx}\left(m^2+7m+12\right)&=0 \\
        e^{mx}(m+4)(m+3) &= 0.
    \end{align*}
    Thus we have $y_h = C_1e^{-4x}+C_2e^{-3x}$.
\end{soln}
\begin{example}[Homogeneous ODE with initial values] 
    $$y''+y;-2y=0, y(0) = 4, y'(0)=-5.$$
\end{example}
\begin{soln}
    Let $y=e^{mx}$. This means $y'=me^{mx}$ and $y''=m^2e^{mx}$. Plugging in,
    we get
    \begin{align*}
        m^2e^{mx}+me^{mx}-2e^{mx} &= 0\\
        e^{mx} \left(m^2+m-2\right) &= 0 \\
        e^{mx}(m-1)(m+2) &=0.
    \end{align*}
    So, $m=-2,1$. Therefore $y_h = C_1e^{-2x} + C_2e^{x}$. Then, we get the 
    following system from the initial values:
    \begin{align*}
         C_1+C_2 &= 4 \\
         -2C_1+C_2&=-5.
    \end{align*}
    Solving, we get $C_1 = 3$ and $C_2 = 1$. So, $\boxed{y_h = 3e^{-2x}+e^{x}}$.
\end{soln}
\begin{example}[Homogeneous ODE with repeated roots]
    $$y''+4y'+4y=0.$$
\end{example}
\begin{soln}
    Let $y=e^{mx}$. This means $y'=me^{mx}$ and $y''=m^2e^{mx}$. PLugging in, 
    we get
    \begin{align*}
        m^2e^{mx}+4me^{mx}+4e^{mx} &= 0 \\
        e^{mx}(m+2)^2 &= 0.
    \end{align*}
    Thus, $\boxed{y_1 = C_1e^{-2x}}$. We now proceed to use the  \alert{reduction of order} 
    method.
    So, $y_2 = f(x)\cdot y_1$. First, we have 
    \begin{align*}
        y_2' &= f'(x)y_1+f(x)y_1' = f'(x)e^{-2x}-2f(x)e^{-2x}\\
        y_2'' &= f''(x)y_1+2f'(x)y_1'+f(x)y_1'' = f''(x)e^{-2x}-4f'(x)e^{-2x}+4f(x)e^{-2x}.
    \end{align*}
    Plugging this into the original differential equation, we get
    \begin{align*}
        f''(x)e^{-2x}-4f'(x)e^{-2x}+4f(x)e^{-2x} + 4\left(f'(x)e^{-2x}-2f(x)e^{-2x} \right)
        + 4f(x)e^{-2x} &= 0.
    \end{align*}
    Simplifying yields $f''(x) = 0$. Now, let $g(x) = f'(x)$. This means
    $g'(x) = f''(x)$. So, $g'(x) = 0$. This is equivalent to $\frac{dg}{dx} = 0$.
    Using separation of variables, we get $g(x) = C$. So, $f'(x) = C$. This is
    the same as $\frac{df}{dx} = C \implies f(x) = C_1x+C_2$. Thus,
    $$\boxed{y_2 = \left(C_1x+C_2\right)e^{-2x}}.$$
    Adding the two solutions, we obtain
    \begin{align*}
        y_h &= y_1 + y_2 = C_0e^{-2x} + C_1 xe^{-2x} +C_2e^{-2x} \\
        y_h &= Ce^{-2x} + Dxe^{-2x}.
    \end{align*}
\end{soln}
\begin{example}
    $$y''+y'+(1/4)y=0;~y(0) = 3; ~ y'(0) = -3.5.$$
\end{example}
\begin{soln}
    Let $y=e^{mx}$. This means $y' = me^{mx}$ and $y''=m^2e^{mx}$. Plugging in,
    we get
    \begin{align*}
        4m^2e^{mx} + 4me^{mx} + e^{mx} &= 0 \\
        e^{mx}(4m^2+4m+1) &=0 \\
        e^{mx}(2m+1)^2 &=0.
    \end{align*}
    Thus, $\boxed{y_1 = C_0e^{-\frac{1}{2}x}}$. We now proceed to use reduction
    of order. So, $y_2 = f(x) \cdot y_1$. First, we have
    \begin{align*}
    y_2' &= f'(x)y_1+f(x)y_1' = f'(x)e^{-x/2}-\frac{1}{2}f(x)e^{-x/2}\\
    y_2'' &= f''(x)y_1+2f'(x)y_1'+f(x)y_1'' = f''(x)e^{-x/2}-f'(x)e^{-x/2}+\frac{1}{4}f(x)e^{-x/2}.
    \end{align*}
    Plugging this into the original differential equation, we get
    \begin{align*}
        f''(x)e^{-x/2}-f'(x)e^{-x/2}+\frac{1}{4}f(x)e^{-x/2} + 
        f'(x)e^{-x/2}-\frac{1}{2}f(x)e^{-x/2} +\frac{1}{4}f(x)e^{-x/2}= 0 \\
        f''(x) = 0.
    \end{align*}
    Now, let $g(x) = f'(x)$. This means that $g'(x) = f''(x)$. So, $g'(x) =0$.
    This means $g(x) = C$. So, $f'(x) =C$. Thus, $f(x) = C_1x+C_2$. THerefore,
    $$y_2 = (C_1x+C_2)e^{-x/2}.$$
    Adding the two solutions, we obtain 
    \begin{align*}
        y_h &= y_1 + y_2 = C_0e^{-x/2} + C_1xe^{-x/2} + C_2e^{-x/2} \\
            &= Ce^{-x/2}+Dxe^{-x/2}.
    \end{align*}
    Using the inital values, we obtain
    $$y_h = 3e^{-x/2}-2xe^{-x/2}.$$
\end{soln}
In general $y_2 = xy_1$.

\begin{example}
    $$y'''+3y''-4y = 0.$$
\end{example}
\begin{soln}
    Let $y=e^{mx}$. This mean $y' = me^{mx}$ and $y'' = m^2e^{mx}$. Plugging
    in, we get 
    \begin{align*}
        m^3e^{mx} + 3m^2e^{mx} -4e^{mx} &= 0 \\
        e^{mx}\left(m^3+3m^2-4\right) &= 0\\
        e^{mx}(m-1)(m^2+4m+4) &= 0\\
        e^{mx}(m-1)(m+2)^2 &= 0.
    \end{align*}
    Therefore, $y_1 = C_1e^x$, $y_2 = C_2e^{-2x}$, and $y_3 = C_3xe^{-2x}$.
    Thus, $$\boxed{y_h = c_1e^{x} + C_2e^{-2x} + C_3xe^{-2x}}.$$
\end{soln}

\begin{example}[Complex Roots]
   $$ y''+4y = 0.$$
\end{example}
\begin{soln}
    Let $y=e^{mx}$. This means that $y'' = m^2e^{mx}$. Plugging in gives
    $m= \pm 2i$. Thus, $y_h = C_1e^{2ix} + C_2e^{-2ix}$. Recall 
    \alert{Euler's Theorem} $$e^{i\theta} = \cos \theta + i\sin \theta.$$
    Plugging this in gives
    \begin{align*}
        y_h &= C_1(\cos 2x + i\sin 2x) + C_2(\cos 2x  -i\sin  2x) \\
        y_h &= C_1\cos 2x + C_2 \sin 2x.
    \end{align*}
\end{soln}
\begin{example}[Complex Roots]
$$y''+8y'+25y = 0.$$
\end{example}
\begin{soln}
    Let $y=e^{mx}$. This meas that $y' = me^{mx}$ and $y'' = m^2e^{mx}$.
    Plugging this in gives $-4\pm 3i$. Thus, 
    \begin{align*}
        y_h &= C_1e^{(-4+3i)x} + C_2e^{(-4-3i)x} \\
        y_h &= e^{-4x}\left(C_1e^{3ix} + C_2e^{-3ix} \right) \\
        y_h &= e^{-4x}\left(C_1 \cos(3x) + C_2 \sin (3x) \right).
    \end{align*}
\end{soln}

\section{Non Homogeneous ODEs}
This occurs when $f(x) \neq 0$.
Our solution will still include the homogeneous potion
$y = y_h(x) + y_p(x)$. Some methods for solving these are
\alert{undetermined coefficients}, which can only be used for scalar coefficients,
and \alert{variation of parameters}, which can be used with scalar or variable 
coefficients.
\newpage
\begin{example}[Undetermined Coefficients]
    $$y''-4y' + 3y = e^{-x};~y(0) = 1;~y'(0)=0.$$
\end{example}
\begin{soln}
    We first find $y_h$ using $y''-4y'+3y = 0$. Thus we obtain
    $$y_h = C_1e^x+C_2e^{3x}.$$ Our guess for $y_p = Ce^{-x}$.
    Thus, $y_p' = -Ce^{-x}$ and $y_p'' = Ce^{-x}$. So, plugging this in,
    we get 
    \begin{align*}
        Ce^{-x}+4Ce^{-x}+3Ce^{-x} = e^{-x} &\implies 8Ce^{-x} = e^{-x} \\
                                           &\implies C = \frac{1}{8}.
    \end{align*}
    Therefore $$y = y_h + y_p = C_1e^{x}+C_2e^{3x} + \frac{1}{8}e^{-x}.$$
    Using the initial values, we find that
    $$\boxed{y = \frac{5}{4}e^{x}-\frac{3}{8}e^{3x} + \frac{1}{8}e^{-x}}.$$
\end{soln}
The following is a useful guessing guide:
\begin{align*}
    r(x) &\implies y_p(x) \\
    ke^{rx} &\implies Ce^{rx} \\
    kx^n &\implies P_n = a_nx^n + a_{n-1}x^{n-1} + \cdots a_0 \\
    k\cos(wx)~\text{or}~k\sin(wx) &\implies a\cos(wx)+b\sin(wx).
\end{align*}
\begin{example}[Guessing Practice with Undetermined Coefficients]
   $$ y''+2y'+y = \cos(2x)$$
\end{example}
\begin{soln}
    We first proceed to find $y_h$. We find that
    $$y_h = C_1e^{-x}+C_2xe^{-x}.$$
    We make the following guess: $y_p = a\cos(2x) + b\sin(2x)$. Solving
    for $a$ and $b$, we find that $y_p = -\frac{3}{25}\cos(2x) + \frac{4}{25}\sin(2x)$.
    Therefore 
    $$\boxed{y = C_1e^{-x}+C_2xe^{-x} - \frac{3}{25}\cos(2x)+\frac{4}{25}\sin(2x)}.$$
\end{soln}
\begin{example}[Bad Guessing]
    $$y''+4y'+3y = e^{-x}.$$
\end{example}
\begin{soln}
    We notice $y_h = C_1e^{-x} + C_2e^{-3x}$. $y_p = Ce^{-x}$ is a bad guess since it is a term present in the
    homogeneous equation. So, we let $y_p = Cxe^{-x}$, which is a guess from
    the result of applying the reduction of order. Solving for $C$, we get
    that $C = \frac{1}{2}$. Therefore 
    $$\boxed{y = C_1e^{-x}+C_2e^{-3x}+\frac{1}{2}xe^{-x}}.$$
\end{soln}

\begin{definition}
    \alert{Variation of Parameter} involve differential equations
    of variable coefficients. For $a_2y''+a_1y'+a_0y=f(x)$. First,
    we make the leading coefficient $1$ by dividing by $a_2$. Thus,
    $$y'' + p(x)y' + q(x)y = r(x).$$ We still do the homogeneous
    portion first: $y_h = C_1y_1+C_2y_2$. Then $y_p = u(x)y_1(x)+v(x)y_2(x)$,
    where $u' = -ry_2/w$ and $v'=ry_1/w$, where 
    $$w = \det \left( \begin{bmatrix} y_1 & y_2 \\ y_1' & y_2' \end{bmatrix}\right).$$
    This determinant is called the \alert{Wronskian}.
\end{definition}
\begin{example}[Variation of parameters]
    $$y''+4y'+4y = e^{-2x}/x^2.$$
\end{example}
\begin{soln}
    We find that $y_h = C_1e^{-2x} + C_2xe^{-2x}$. Notice that the Wronskian
    is $$w =\det \left( \begin{bmatrix} e^{-2x} & xe^{-2x} \\ -2e^{-2x} & e^{-2x}-2xe^{-2x}
    \end{bmatrix}\right) = e^{-4x}.$$ Thus,
    \begin{align*}
        u'(x) &= -\frac{1}{x} \\
        v'(x) &= \frac{1}{x^2}.
    \end{align*}
    Thus, $u(x)=-\ln|x|$ and $v(x) = -\frac{1}{x}$. Therefore,
    $$y_p = \ln |x|e^{2x} - e^{-2x} \implies \boxed{y=C_1e^{-2x}+C_2xe^{-2x}+\ln|x|e^{2x}}.$$
\end{soln}
\begin{example}[Undetermined Coefficients]
    $$y''+y'+y = 3x^2+4.$$
\end{example}
\begin{soln}
    We first find that $$y_h = e^{(-1/2)x}\left( C_1\cos(\sqrt{3}x/2)+C_2\sin(\sqrt{3}x/2)\right).$$
    Then we let $y_p = D_1x^2+D_2x+D_3$. Therefore
    \begin{align*}
        2D_1+2xD_1+D_2+D_1x^2+D_2x+D_3 = 3x^2+4 \\
        x^2\left(D_1\right)+x\left(2D_1+D_2\right)+\left(2D_1+D_2+D_3\right)=3x^2+4.
    \end{align*}
    Solving the resulting system yields $D_1 = 3, D_2 = -6, D_3 = 4$.
    Therefore $$y_p = 3x^2-6x+4.$$ So,
    $$\boxed{y = e^{(-1/2)x}\left( C_1\cos(\sqrt{3}x/2)+C_2\sin(\sqrt{3}x/2)\right)+3x^2-6x+4}.$$
\end{soln}

%\section{Problems}
%\begin{problem}
%    Find $y$ for the following differential equation and initial values
%    $$y''+4y'+5y = 0; ~ y(0) = 1; ~ y'(0) = -4.$$
%\end{problem}
%\begin{problem}
%    Find $y$ for the following differential equation and initial values
%    $$y''- 4y'+4y = 0; ~ y(0) = 1; ~ y'(0) = 0.$$
%\end{problem}
%\begin{problem}
%    Find $y$ for the following differential equation and initial values
%    $$y'''-7y'+6y = 0; ~ y(0) = 0; ~ y'(0) = 0; ~ y''(0) = 1.$$
%\end{problem}
