\chapter{Differential Equations}
\section{Separable Differential Equations}

A separable differential equation can be simplified to the form:
$$g(y)y'=f(x) \implies g(y)\dif y = f(x) \dif x,$$
where $f$ and $g$ are functions of $x$ and $y$ respectively. Letting
$G'(y)=g(y)$ and $F'(x)=f(x)$ and taking the integral of both sides of the
differential equation, we get $$G(y) = F(x)+C$$ for some constant $C$. Using
a separation of variables is most helpful as a first try when attempting
first-order linear ordinary differential equations. It is also used as a very
useful intermediate step in solving more complex differential equations. We go 
more in detail later in the chapter.


%\begin{example}
%    Find $y$ for the following differential equation:
%    $$\frac{dy}{dx} = x.$$
%\end{example}
%\begin{soln}
%    We see that $dy = x ~ dx$. Taking the integral of both sides, we obtain
%    $$y = \frac{1}{2} x^2 + C.$$
%\end{soln}
%
%\begin{example}
%    Find $y$ for the following differential equation:
%    $$\frac{dy}{dx} = \frac{1}{x}.$$
%\end{example}
%\begin{soln}
%    We see that $dy = \frac{1}{x} ~ dx$. Taking the integral of both sides,
%    we obtain $$y = \ln|x| + C.$$
%\end{soln}
%\begin{example}
%    Find $y$ for the following differential equation:
%    $$\frac{dy}{dx} = \cos x.$$
%\end{example}
%\begin{soln}
%    We see that $dy = \cos x ~ dx$. Taking the integral of both sides, we obtain
%    $$\boxed{y = \sin x + C}.$$
%\end{soln}
%\begin{example}
%    Find $y$ for the following differential equation:
%    $$\frac{dy}{dx} = e^x.$$
%\end{example}
%\begin{soln}
%    We see that $dy = e^x ~ dx$. Taking the integral of borth sides, we obtain
%    $$\boxed{y =  e^x + C}.$$
%\end{soln}
%\begin{example}
%    Find $y$ for the following differential equation: 
%    $$\frac{dy}{dx} = xy.$$
%\end{example}
%\begin{soln}
%    We see that $\frac{1}{y} ~ dy  = x ~ dx$. Taking the integral of
%    both sides, we get
%    $$\ln |y| = \frac{1}{2}x^2 + C \implies y = e^{\frac{1}{2}x^2+C}.$$
%\end{soln}
\begin{example}[Separable Differential Eqiation]
    Solve for $y$:
    $$\frac{\dif y}{\dif x} = x^2y-2xy.$$
\end{example}
\begin{soln}
    Separating the variables, we see that $\frac{1}{y} \dif y = (x^2-2x) \dif x$.
    Taking the integral of both sides yields
    $$\ln y = \frac{1}{3}x^3-x^2 + A \implies y = Ae^{\frac{1}{3}x^3-x^2}.$$
\end{soln}
%\begin{example}
%    Find $y$ for the following differential equation:
%    $$(x^2+x)~\frac{dy}{dx} = y-1.$$
%\end{example}
%\begin{soln}
%    We see that $\frac{1}{y-1} ~ dy = \frac{1}{x^2+x} ~ dx$. Taking the
%    integral of both sides, we find that
%    $$\ln|y-1| = \ln|x|-\ln|x+1| +C\implies y = C\left|\frac{x}{x+1}\right|+1.$$
%\end{soln}
\begin{question}
    What is $y$ when given the initial condition $y(0)=e$?
\end{question}
%\begin{soln}
%    By a previous example we have $$y = C\left(e^{\frac{1}{3}x^3-x^2}\right).$$
%    By the initial value, we solve for $C$ to get $C = e$. Therefore,
%    $$\boxed{y = e^{\frac{1}{3}x^3-x^2+1}}.$$
%\end{soln}

\section{Homogeneous Ordinary Differential Equations}
The general from of a linear ordinary differential equation(ODE) is
$$a_ny^{(n)} +a_{n-1}y^{(n-1)}+\cdots+a_1y'+a_0y = f(x),$$
where $a_i \in \RR[x]$ for $i \in \{0, 1, \dots, n\}$ and $y^{(j)}$ denotes
the $j$th derivative of $y$. It is then said that this ODE
has \alert{order} $n$ since it is the highest derivative in the equation. An
ODE is said to be \alert{homogenous} if $f(x) = 0$. Otherwise, it is said to be 
a \alert{nonhomogeneous} ODE. The most common method of approaching homogeneous
ODEs is ansatz. This is an educated guess that is made to help solve a problem.
This will become apparent not only in homogeneous ODEs but more complex ones
as well.
%\begin{example}[ODE]
%    $$\frac{d^2f}{dx^2} + 3 \frac{df}{dx} + 5 = 0  \implies y''+3y'+5=0.$$
%\end{example}
%\begin{remark}
%    Partial differential equations also exist.
%\end{remark}
%\begin{example}[PDE]
%    $$\frac{\partial^2f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2} = 0.$$
%\end{example}

%\begin{definition}
%    A \alert{homogeneous} ordinary differential equation is one with $f(x) = 0$ 
%    and has constant coefficients.
%\end{definition}

\begin{example}[Homogeneous ODE]
    Solve for y:  $$y''+7y'+12y=0.$$ 
\end{example}
\begin{soln}
    Functions of the
    form $y=e^{mx}$ are an educated guess for solving homoegeneous ODEs. So,
    letting $y=e^{mx}$ means $y' = me^{mx}$ and $y''= m^2e^{mx}$. Plugging
    these in our differential equation,
    \begin{align*}
        m^2e^{mx}+7me^{mx}+12e^{mx}&=0 \\
        e^{mx}\left(m^2+7m+12\right)&=0 \\
        e^{mx}(m+4)(m+3) &= 0.
    \end{align*}
    Therefore, $m=-4,-3$, implying that $y_1=C_1e^{-4x}$ and $y_2=C_2e^{-3x}$. 
    This means that our solution of the differential
    equation is $$y_h = y_1+y_2 =  C_1e^{-4x} + C_2e^{-3x}.$$
\end{soln}

At first, it might be puzzling why we consider $y=e^{mx}$ to be an educated
guess for solving homogeneous ODEs with constant coeficients. However, let us
consider the following first-order differential equation 
$$y'+ky=0 \implies y' = -ky.$$ Here, it is natural to guess that $y=e^{mx}$
because $e^{mx}$ is the only function where its derivative is equal to some
scalar multiple of itsself. So, for other homogeneous ODEs with constant
coefficient and of higher degree, we also use the guess as a means
of finding the general solution.
\begin{exercise}[Homogeneous ODE with initial values]
    $$y''+y'-2y=0,~y(0) = 4,~y'(0)=-5.$$
\end{exercise}
%\begin{soln}
%    Let $y=e^{mx}$. This means $y'=me^{mx}$ and $y''=m^2e^{mx}$. Plugging in,
%    we get
%    \begin{align*}
%        m^2e^{mx}+me^{mx}-2e^{mx} &= 0\\
%        e^{mx} \left(m^2+m-2\right) &= 0 \\
%        e^{mx}(m-1)(m+2) &=0.
%    \end{align*}
%    So, $m=-2,1$. Therefore $y_h = C_1e^{-2x} + C_2e^{x}$. Then, we get the 
%    following system from the initial values:
%    \begin{align*}
%         C_1+C_2 &= 4 \\
%         -2C_1+C_2&=-5.
%    \end{align*}
%    Solving, we get $C_1 = 3$ and $C_2 = 1$. So, $\boxed{y_h = 3e^{-2x}+e^{x}}$.
%\end{soln}

Now, we consider what happens if we get a polynomial with repeated roots or
if we are already given a solution to the differential equation.
\begin{example}[Homogeneous ODE with repeated roots]
    Solve for $y$: $$y''+4y'+4y=0.$$
\end{example}
\begin{soln}
    Let $y=e^{mx}$. This means $y'=me^{mx}$ and $y''=m^2e^{mx}$. Plugging in, 
    we get
    \begin{align*}
        m^2e^{mx}+4me^{mx}+4e^{mx} &= 0 \\
        e^{mx}(m+2)^2 &= 0.
    \end{align*}
    Therefore, the first fundamental solution is
    $y_1 = e^{-2x}$. However, it is not clear what the second fundamental solution
    to this differential equation is. In order to determine this, we use the method
    of \alert{reduction of order}. This involves letting the second fundamental
    solution being the product of $y_1$ and some function of $x$, say $f(x)$.
    So, let $y_2 = f(x)\cdot y_1$. Now, we seek to find what $f(x)$ is. Thus, 
    we want to find the first and second derivatives of $y_2$ in order to plug it
    back into the original differential equation. This will aid us in finding
    out more information regarding $f(x)$. Therefore, we have 
    \begin{align*}
        y_2' &= f'(x)y_1+f(x)y_1' \\
             &= f'(x)e^{-2x}-2f(x)e^{-2x}\\
        y_2'' &= f''(x)y_1+2f'(x)y_1'+f(x)y_1'' \\
              &= f''(x)e^{-2x}-4f'(x)e^{-2x}+4f(x)e^{-2x}.
    \end{align*}
    Plugging this into the original differential equation and simplifying fully
    yields $f''(x) = 0$.
    %\begin{align*}
    %    f''(x)e^{-2x}-4f'(x)e^{-2x}+4f(x)e^{-2x} + 4\left(f'(x)e^{-2x}-2f(x)e^{-2x} \right)
    %    + 4f(x)e^{-2x} &= 0.
    %\end{align*}
    Now, let $g(x) = f'(x)$. This means $g'(x) = f''(x)$. So, $g'(x) = 0$. 
    Solving for $g(x)$ we get $g(x) = A$. Therefore, $f'(x) = A$. Solving for
    $f(x)$ then gives $f(x) = Ax + B$. Thus, 
    $$y_2 = (Ax+B)e^{-2x} \implies y_2 = xe^{-2x}$$
    since $y_2$ must be linearly independent from $y_1$.
    Finally, we find the solution to the differential equation to be
    \begin{align*}
        y = c_1y_1 + c_2y_2 = c_1e^{-2x} + c_2xe^{-2x}. 
    \end{align*}
\end{soln}
\begin{theorem}[Reduction of Order]
    Consider a general homogeneous linear ODE of order two:
    $$y''(x)+p(x)y'(x)+q(x)y(x)=0$$
    and suppose $y_1(x)$ is one solution to the differential equation. Then
    the second solution to the differential equation is
    $$y_2(x) = y_1(x)\int \frac{u(x)}{[y_1(x)]^2} \dif x,$$
    where $u(x) = e^{-\int p(x) \dif x}$.
\end{theorem}
\begin{proof}
    We assume the second solution is of the form $y_2(x) = f(x)y_1(x)$ for
    some function $f$. Thus,
    $$y_2' = f'y_1+fy_1'~~~~y_2'' = f''y_1+2f'y_1'+fy_1''.$$
    Substituting these expressions back into the original differential
    equation, we get
    $$f''y_1+2f'y_1'+fy_1''+p(f'y_1+fy_1')+qfy_1 = 0.$$ Rearranging these
    terms, we obtain $$f(y_1''+py_1'+qy_1)+f''y_1+2f'y_1'+pf'y_1 = 0.$$ Notice
    that the term in the parentheses becomes $0$ since $y_1$ is a solution
    to the differential equation. Therefore, we are simply left with
    $$f''y_1+2f'y_1'+pf'y_1 = 0.$$ Rearranging and letting $g(x) = f'(x)$,
    $$g'(x) = -g(x)\left(2\frac{y_1'(x)}{y_1(x)}+p(x)\right).$$ Now, we simply
    have a first-order ODE in terms of $g(x)$. It can then be shown that
    $f(x) = \int \frac{u(x)}{[y_1(x)]^2} \dif x$ where 
    $u(x) = e^{-\int p(x) \dif x}$. It then follows that
    $$y_2(x) = y_1(x)\int \frac{u(x)}{[y_1(x)]^2} \dif x.$$
\end{proof}
\begin{corollary}[Reduction of Order with Constant Coefficients]
    Consider a homogeneous linear ODE with constant coeffiecients:
    $$ay''(x)+by'(x)+cy(x) = 0$$ where $a,b,c \in \RR \text{\textbackslash} \{0\}$ and suppose the 
    discriminant, $b^2-4ac$, vanishes due to the presence of a repeated
    root in the characteristic equation. Additionally suppose $y_1(x)$ is 
    one solution to the differential equation. Then the second solution to the
    differential equation is $y_2(x) = xy_1(x)$.
\end{corollary}
\begin{proof}
    Letting $y=e^{mx}$ and solving for $m$ from the resulting characteristic
    equation gives $m = -\frac{b}{2a}$. Therefore $y_1(x) = e^{-\frac{b}{2a}x}$.
\end{proof}
\begin{example}[Reduction of Order]
    Solve for $y$: $$y''+y'+(1/4)y=0;~y(0) = 3; ~ y'(0) = -3.5.$$
\end{example}
\begin{soln}
    Let $y=e^{mx}$. This means $y' = me^{mx}$ and $y''=m^2e^{mx}$. Plugging in,
    we get
    \begin{align*}
        4m^2e^{mx} + 4me^{mx} + e^{mx} &= 0 \\
        e^{mx}(4m^2+4m+1) &=0 \\
        e^{mx}(2m+1)^2 &=0.
    \end{align*}
    Therefore $y_1 = e^{-x/2}$. Then, by the general result of reduction of order
    on a homogeneous linear ODE with constant coefficients gives $y_2 = x\cdot y_1$.
    So, the solution to the differential equation is 
    \begin{align*}
        y = c_1e^{-x/2} + c_2 x e^{-x/2}
    \end{align*}
    Using the inital values to solve for constants $c_1$ and $c_2$, we finally
    find
    $$y = 3e^{-x/2}-2xe^{-x/2}.$$
\end{soln}
\begin{example}[Reduction of Order]
    $$y'''+3y''-4y = 0.$$
\end{example}
\begin{soln}
    Let $y=e^{mx}$. This mean $y' = me^{mx}$ and $y'' = m^2e^{mx}$. Plugging
    in, we get 
    \begin{align*}
        m^3e^{mx} + 3m^2e^{mx} -4e^{mx} &= 0 \\
        e^{mx}\left(m^3+3m^2-4\right) &= 0\\
        e^{mx}(m-1)(m^2+4m+4) &= 0\\
        e^{mx}(m-1)(m+2)^2 &= 0.
    \end{align*}
    Therefore, $y_1 = e^x$, $y_2 = e^{-2x}$, and $y_3 = xe^{-2x}$.
    Thus, $$y_h = c_1e^{x} + c_2e^{-2x} + c_3xe^{-2x}.$$
\end{soln}
Thus far, we have examined ODEs which had characteristic equations with real
roots. However, it may be the case that these characteristic equations obtain
complex roots. The help of \alert{euler's formula} helps to clear any complex
numbers in the solution.

\begin{theorem}[Euler's Formula]
    For any complex number $x$, $$e^{ix} = \cos x + i \sin x.$$
\end{theorem}
\begin{proof}
    A taylor series expansion of both sides gives the result.
\end{proof}
\begin{example}[Complex Roots]
   Solve for $y$: $$ y''+4y = 0.$$
\end{example}
\begin{soln}
    Let $y=e^{mx}$. This means that $y'' = m^2e^{mx}$. Plugging in gives
    $m= \pm 2i$. Thus, $$y = c_1e^{2ix} + c_2e^{-2ix}.$$ By Euler's Formula,
    \begin{align*}
        y &= c_1(\cos 2x + i\sin 2x) + c_2(\cos 2x  -i\sin  2x) \\
        y &= c_1\cos 2x + c_2 \sin 2x.
    \end{align*}
\end{soln}
\begin{example}[Complex Roots]
$$y''+8y'+25y = 0.$$
\end{example}
\begin{soln}
    Let $y=e^{mx}$. This meas that $y' = me^{mx}$ and $y'' = m^2e^{mx}$.
    Plugging this in gives $-4\pm 3i$. Thus, 
    \begin{align*}
        y_h &= C_1e^{(-4+3i)x} + C_2e^{(-4-3i)x} \\
        y_h &= e^{-4x}\left(C_1e^{3ix} + C_2e^{-3ix} \right) \\
        y_h &= e^{-4x}\left(C_1 \cos(3x) + C_2 \sin (3x) \right).
    \end{align*}
\end{soln}

\section{Nonhomogeneous Ordinary Differential Equations}
A \alert{nonhomogeneous} differential equation is of the form
$$a_ny^{(n)} +a_{n-1}y^{(n-1)}+\cdots+a_1y'+a_0y = f(x)$$
where $a_i \in \RR[x]$ for $i \in \{1,2,\dots,i\}$ and $f(x) \neq 0$. 
The general solution to a nonhomogeneous
differential equation is $y = y_h+y_p$, where $y_h$ is found from letting
the left hand side equal $0$ and the particular solution, $y_p$, is found
by using one of two methods, namely \alert{undetermined coefficients} or
\alert{variation of parameters}. Undetermined coefficients can only be used
with differential equations with scalar coefficients while variation of parameters
can be used with scalar or variable coefficients.

\begin{theorem}[Undetermined Coefficients]
    Consider the differential equation
    $$a_2y''(x)+a_1y'(x)+a_0y(x) = f(x).$$
    In order to solve for the particular solution, $y_p$, we guess $y_p$
    based on the follwing table
    \begin{center}
        \begin{tabular}{|c|c|}
        \hline
        $f(x)$ & $y_p(x)$ \\
        \hline
        $ae^{\beta x}$ & $Ae^{\beta x}$ \\
        $a\cos(\beta x)$ & $A\cos(\beta x)+B\sin(\beta x)$ \\
        $b\sin(\beta x)$ & $A\cos(\beta x)+B\sin(\beta x)$ \\
        $a\cos(\beta x)+b\sin(\beta x)$ & $A\cos(\beta x)+B\sin(\beta x)$ \\
        $n$th deg polynomial & $A_nx^n+A_{n-1}x^{n-1}+\cdots+A_0$ \\
        \hline
        \end{tabular}
    \end{center}
    In addition, if $f(x)$ is a linear combination of any of the forms
    above, then $y_p(x)$ is also a linear combination of the guesses for
    each of the forms present in $f(x)$.
\end{theorem}

\begin{example}[Undetermined Coefficients]
    $$y''-4y' + 3y = e^{-x};~y(0) = 1;~y'(0)=0.$$
\end{example}
\begin{soln}
    We first find $y_h$ using $y''-4y'+3y = 0$. Thus we obtain
    $$y_h = C_1e^x+C_2e^{3x}.$$ Our guess for $y_p = Ce^{-x}$.
    Thus, $y_p' = -Ce^{-x}$ and $y_p'' = Ce^{-x}$. So, plugging this in,
    we get 
    \begin{align*}
        Ce^{-x}+4Ce^{-x}+3Ce^{-x} = e^{-x} &\implies 8Ce^{-x} = e^{-x} \\
                                           &\implies C = \frac{1}{8}.
    \end{align*}
    Therefore $$y = y_h + y_p = C_1e^{x}+C_2e^{3x} + \frac{1}{8}e^{-x}.$$
    Using the initial values, we find that
    $$\boxed{y = \frac{5}{4}e^{x}-\frac{3}{8}e^{3x} + \frac{1}{8}e^{-x}}.$$
\end{soln}
\begin{example}[Guessing Practice with Undetermined Coefficients]
   $$ y''+2y'+y = \cos(2x)$$
\end{example}
\begin{soln}
    We first proceed to find $y_h$. We find that
    $$y_h = C_1e^{-x}+C_2xe^{-x}.$$
    We make the following guess: $y_p = a\cos(2x) + b\sin(2x)$. Solving
    for $a$ and $b$, we find that $y_p = -\frac{3}{25}\cos(2x) + \frac{4}{25}\sin(2x)$.
    Therefore 
    $$\boxed{y = C_1e^{-x}+C_2xe^{-x} - \frac{3}{25}\cos(2x)+\frac{4}{25}\sin(2x)}.$$
\end{soln}
\begin{example}[Bad Guessing]
    $$y''+4y'+3y = e^{-x}.$$
\end{example}
\begin{soln}
    We notice $y_h = C_1e^{-x} + C_2e^{-3x}$. $y_p = Ce^{-x}$ is a bad guess since it is a term present in the
    homogeneous equation. So, we let $y_p = Cxe^{-x}$, which is a guess from
    the result of applying the reduction of order. Solving for $C$, we get
    that $C = \frac{1}{2}$. Therefore 
    $$\boxed{y = C_1e^{-x}+C_2e^{-3x}+\frac{1}{2}xe^{-x}}.$$
\end{soln}
\begin{theorem}[Variation of Parameters]
    The method of variation of parameters is a technique for finding a particular 
    solution to a nonhomogeneous linear second order ODE:
    $$y''+P(x)y'+Q(x)y = R(x)$$
    provided that the general solution of the corresponding homogeneous linear 
    second order ODE:
    $$y''+P(x)y'+Q(x)y = 0$$ is already known. The particular solution is then
    $$y_p = u(x)y_1(x)+v(x)y_2(x)$$ such that
    $$u'(x) = -\frac{y_2R(x)}{W(y_1,y_2)}~\text{and}~v'(x) = \frac{y_1R(x)}{W(y_1,y_2)},$$
    where $W(y_1,y_2)$ denotes the Wronskian of $y_1$ and $y_2$.
\end{theorem}
\begin{proof}
    First, we have
    \begin{align*}
        y_p' &= \left(u'y_1+uy_1'\right) + \left(v'y_2+vy_2'\right) \\
             &= \left(uy_1'+vy_2'\right) + \left(u'y_1+v'y_2\right)
    \end{align*}
    by the product rule.
\end{proof}
\begin{example}[Variation of parameters]
    $$y''+4y'+4y = e^{-2x}/x^2.$$
\end{example}
\begin{soln}
    We find that $y_h = C_1e^{-2x} + C_2xe^{-2x}$. Notice that the Wronskian
    is $$w =\det \left( \begin{bmatrix} e^{-2x} & xe^{-2x} \\ -2e^{-2x} & e^{-2x}-2xe^{-2x}
    \end{bmatrix}\right) = e^{-4x}.$$ Thus,
    \begin{align*}
        u'(x) &= -\frac{1}{x} \\
        v'(x) &= \frac{1}{x^2}.
    \end{align*}
    Thus, $u(x)=-\ln|x|$ and $v(x) = -\frac{1}{x}$. Therefore,
    $$y_p = \ln |x|e^{2x} - e^{-2x} \implies \boxed{y=C_1e^{-2x}+C_2xe^{-2x}+\ln|x|e^{2x}}.$$
\end{soln}
\begin{example}[Undetermined Coefficients]
    $$y''+y'+y = 3x^2+4.$$
\end{example}
\begin{soln}
    We first find that $$y_h = e^{(-1/2)x}\left( C_1\cos(\sqrt{3}x/2)+C_2\sin(\sqrt{3}x/2)\right).$$
    Then we let $y_p = D_1x^2+D_2x+D_3$. Therefore
    \begin{align*}
        2D_1+2xD_1+D_2+D_1x^2+D_2x+D_3 = 3x^2+4 \\
        x^2\left(D_1\right)+x\left(2D_1+D_2\right)+\left(2D_1+D_2+D_3\right)=3x^2+4.
    \end{align*}
    Solving the resulting system yields $D_1 = 3, D_2 = -6, D_3 = 4$.
    Therefore $$y_p = 3x^2-6x+4.$$ So,
    $$\boxed{y = e^{(-1/2)x}\left( C_1\cos(\sqrt{3}x/2)+C_2\sin(\sqrt{3}x/2)\right)+3x^2-6x+4}.$$
\end{soln}

\begin{example}[Variation of parameters]
    $$y''+4y = \tan x.$$
\end{example}
\begin{soln}
    We first find $y_h = C_1\cos(2x)+C_2\sin(2x)$. Now, we notice that
    wronskian is 
    $$w = \det \left( \begin{bmatrix}\cos(2x)&\sin(2x) \\ -2\sin(2x) & 2\cos(2x) \end{bmatrix}\right)
    =2.$$ Thus, $$u'(x) = -\frac{\tan x \sin (2x)}{2} = -\sin^2(x)$$
    and $$v'(x) = \frac{1}{2}\ln |\cos x| - \frac{\cos(2x)}{4} = \frac{\sin(2x)}{2}-\frac{1}{2}\tan x.$$
    Solving, we find $u(x) = \frac{\sin(2x)}{4} - \frac{1}{2}x$. 
    $v(x) = \frac{1}{2}\ln |\cos x| - \frac{\cos 2x}{4}$. Thus,
    $$y_p = -\frac{1}{2}\cos(2x)+\frac{1}{2}\sin(2x)\ln |\cos x|.$$
    So, $$y = C_1\cos(2x)+C_2\sin(2x)-\frac{1}{2}\cos(2x)+\frac{1}{2}\sin(2x)\ln |\cos x|$$
\end{soln}
\begin{exercise}
    Find $y$ for the differential equation $y''+3y'+2y=\frac{1}{1+e^x}$.
\end{exercise}

\section{Ordinary Differential Equations with Variable Coefficients}
\alert{Euler's Equation} is the following
$$a_nx^ny^{(n)} + a_{n-1}x^{n-1}y^{(n-1)} + \cdots +a_1xy'+a_0y = f(x).$$
The methods for solving these differential equations are the 
\alert{transformation method}, which changes to an equation with constant
coefficients, and the \alert{direct method}.

\begin{theorem}[Transformation Method]
    Let $x = e^{z}$. Plugging in $e^z$ into $y(x)$, we get $\hat{y}(z)$.
    Thus, $$y' = \frac{\dif y}{\dif x} = \frac{\dif \hat{y}}{\dif z}\frac{\dif z}{\dif x} = 
    \hat{y}' \frac{\dif z}{\dif x} = \hat{y}' \frac{1}{x}.$$ Then, $y''$ follows
    to be $$y'' = \frac{\hat{y}''-\hat{y}'}{x^2}.$$
\end{theorem}
\begin{exercise}
    Find $y'''$.
\end{exercise}
\begin{example}[Transformation Method]
    We seek to solve the differential equation $$x^2y''-xy'+y=0.$$
    Using the transformation method, we get
    $$x^2\left(\frac{\hat{y}''-\hat{y}'}{x^2}\right) 
    - x\left( \frac{\hat{y}'}{x}\right)+\hat{y} = 0.$$ Simplifying gives
    $$\hat{y}''-2\hat{y}'+\hat{y} = 0.$$ This is now a differential
    equation with constant coefficients, which we know how to solve easily.
    Thus, we let $\hat{y} = e^{mz}$. Then, $\hat{y_h} = Ae^{z}+Bze^{z}$. Putting
    everything in $x$, we get $$y_h = Ax+Bx\ln x.$$
\end{example}
\begin{theorem}[Direct Method]
    Assume $y=x^m$, where $m \in \CC$.
\end{theorem}
\newpage
\begin{example}[Direct Method]
    We seek to solve the differential equation $$x^2y''-xy'+y = 0.$$
    Letting $y=x^m$, we have $y' = mx^{m-1}$ and $y'' = m(m-1)x^{m-2}$.
    Plugging in, we get $x^m\left(m^2-2m+1\right) = 0$. Therefore, $m=1$,
    meaning that $y_1 = C_1x$
    We now proceed to use reduction of order. Thus, $y_2 = f(x)y_1$.
    So, 
    \begin{align*}
        y_2' &= f'y_1+fy_1'=f'x+f \\
        y_2'' &= f''y_1+2f'y_1'+y_1''=f''x+2f'.
    \end{align*}
    Plugging this back into the original differential equation, we get
    $$x^2\left(xf''(x)+2f'(x)\right)-x\left(xf'(x)+f(x)\right)+xf(x) = 0.$$
    Simplifying and rearranging, we get $$x^3f''(x)+x^2f'(x) = 0.$$ Letting
    $g(x) = f'(x)$, we obtain the following separable differential equation
    $$\frac{1}{g} \frac{\dif g}{\dif x} = -\frac{1}{x} \implies g(x) = \frac{1}{x}.$$
    Thus, $f(x) = \ln x$. Finally, $y_2 = x \ln x$ and $$y_h = Ax+Bx\ln x.$$
\end{example}
\begin{exercise}
    Solve the differential equation $x^3y'''+2x^2y''+xy'-y = 0$.
\end{exercise}
\begin{example}[Nonhomogeneous Euler's]
    We seek to solve the differential equation $$x^2y''-xy'+y=x^5.$$
    Using the trasformation method, we get $$\hat{y}''-2\hat{y}'+\hat{y}=e^{5z}.$$
    Now, we can simply use undetermined coefficients. Solving for the
    homogeneous solution, we get $\hat{y_h} = Ae^z+Bze^z$. Then, we
    get $\hat{y_p} = \frac{1}{16}e^{5z}$ So, $y_h = Ax+Bx\ln x$ and
    $y_p = \frac{1}{16}x^5$. Finally, $$y = Ax+Bx\ln x + \frac{1}{16}x^5.$$
\end{example}
\begin{exercise}
    Solve the differentiual equation  $x^2y''+3xy+y = \frac{1}{x\left(\ln x \right)^2}$.
    Hint: use variation of parameters.
\end{exercise}

\section{System of Linear ODEs}
An example of a system of linear odes is a spring system in series. Our first
goal is to change the system that can be written as
$$\begin{bmatrix} y_1' \\ y_2'\end{bmatrix} = \bold{A}\begin{bmatrix} y_1 \\y_2 \end{bmatrix},$$
where $\bold{A}$ is a square matrix. Now, assume, $y = [C]e^{\lambda x}$
where $[C]$ and $\lambda$ are an eigenvalue/vector pair of $\bold{A}$.  Then,
the eigenvalues and eigenvectors of $\bold{A}$ form the fundamential solutions
$$y_h = \alpha_1 c_1e^{\lambda_1 x} + \alpha_2 c_2e^{\lambda_2 x}.$$
\begin{example}
    We seek to solve the following system of differential equations.
    \begin{align*}
        y_1'+2y_1+y_2'+6y_2 &= 0 \\
        2y_1'+3y_1+3y_2'+8y_2 &= 0,
    \end{align*}
    where $$y(0) = \begin{bmatrix} 1 \\ 0\end{bmatrix}.$$
    First, we isolate $y_1'$ from the first equation to obtain
    $$y_1' = -2y_1-y_2'-6y_2.$$ Then, plugging this into the second equation and
    simplifying, we find $$y_2' = 4y_2+y_1.$$ $y_1'$ follows to be
    $$y_1' = -10y_2-3y_1.$$ Thus, 
    $$\begin{bmatrix}y_1' \\ y_2' \end{bmatrix} = 
    \begin{bmatrix} -3 & -10 \\ 1 & 4 \end{bmatrix}\begin{bmatrix}y_1 \\ y_2 \end{bmatrix}.$$
    The eigenvalues and eigenvectors of $\bold{A}$ are 
    $$\lambda_1 = -1,~\lambda_2 = 2, ~ \bold{E}_1 = 
    \begin{bmatrix}-5 \\ 1\end{bmatrix}, ~ \bold{E}_2 = \begin{bmatrix} -2 \\ 1\end{bmatrix}.$$
    Therefore, $$y_h = \alpha_1\begin{bmatrix}-5 \\ 1\end{bmatrix}e^{-x}
    +\alpha_2 \begin{bmatrix} -2 \\ 1\end{bmatrix}e^{2x}.$$
    Solving for $\alpha_1$ and $\alpha_2$, we get $\alpha_1 = -\frac{1}{3}$
    and $\alpha_2 = \frac{1}{3}$. Finally,
    $$y_h = -\frac{1}{3}\begin{bmatrix}-5 \\ 1\end{bmatrix}e^{-x}
    +\frac{1}{3} \begin{bmatrix} -2 \\ 1\end{bmatrix}e^{2x}.$$
\end{example}
\begin{exercise}
    Solve the following system of linear odes: 
    $$y' = \begin{bmatrix} 0 & 1 \\ -4 & 0\end{bmatrix}y;~y(0)=
    \begin{bmatrix} 0 \\ 1\end{bmatrix}.$$
\end{exercise}

\begin{example}[Repeated Roots with a basis]
    We seek to solve the following system of differential equations
    $$y' = \begin{bmatrix}1 & -2 & 2 \\ -2 & 1 & -2 
        \\ 2 & -2 & 1 \end{bmatrix}y; ~ y(0) = \begin{bmatrix}1 \\ 0 \\ 0\end{bmatrix}.$$
        The eigenvalues for $\bold{A}$ are $$\lambda_{1/2} = -1,~\lambda_3 = 5.$$
        The eigenvectors for $\bold{A}$ are
        $$\bold{E}_1 \begin{bmatrix} 1 \\ 1 \\ 0\end{bmatrix},~\bold{E}_2 = 
        \begin{bmatrix} 0 \\ 1 \\ 1\end{bmatrix},~\bold{E}_3 = 
        \begin{bmatrix}1 \\ -1 \\ 1 \end{bmatrix}.$$
        Therefore, 
        $$y_h =\alpha_1 \begin{bmatrix} 1 \\ 1 \\ 0\end{bmatrix}e^{-x}
              +\alpha_2 \begin{bmatrix} 0 \\ 1 \\ 1\end{bmatrix} e^{-x}
              +\alpha_3 \begin{bmatrix}1 \\ -1 \\ 1 \end{bmatrix}e^{5x}.$$
        Solving for the constants, we find
        $$y_h = \frac{1}{3} \begin{bmatrix} 2 \\ 1 \\ -1\end{bmatrix}e^{-x}
        +\frac{1}{3} \begin{bmatrix}1 \\ -1 \\ 1 \end{bmatrix}e^{5x}.$$
\end{example}
\newpage
\begin{example}[Repeated Roots with no Basis]
    We seek to solve the following systems of differentials 
    $$y' = \begin{bmatrix} 8 & 1 \\ -4 & 4\end{bmatrix}y;~y(0) =  
    \begin{bmatrix} 17 \\ 42 \end{bmatrix}.$$
    The eigenvalue of $\bold{A}$ is $\lambda = 6$, where the eigenvector
    is $\bold{C} = \begin{bmatrix} -1 \\ 2 \end{bmatrix}$. Therefore,
    $y_1 = \alpha_1\begin{bmatrix} -1 \\ 2 \end{bmatrix}e^{6x}.$ Now,
    we proceed to use a method that is similar to reduction of order. Thus,
    we let 
    $$y_2 = \begin{bmatrix} a+bx \\ c+dx \end{bmatrix} e^{6x} \implies
    y_2' = \begin{bmatrix} b \\ d \end{bmatrix} e^{6x}+
    \begin{bmatrix} -1 \\ 2 \end{bmatrix}6e^{6x}$$
    Plugging into the original differentual equation, we have
    $$\begin{bmatrix} b \\ d \end{bmatrix} e^{6x}+
    \begin{bmatrix} -1 \\ 2 \end{bmatrix}6e^{6x} = 
    \begin{bmatrix} 8 & 1 \\ -4 & 4\end{bmatrix}\begin{bmatrix} a+bx \\ c+dx \end{bmatrix} e^{6x}$$
    Therefore,
    $$\begin{bmatrix} b+6a \\ d+6c \end{bmatrix}e^{6x}+\begin{bmatrix} 6b \\ 6d \end{bmatrix}xe^{6x} = 
    \begin{bmatrix} 8a+c \\ -4a+4c \end{bmatrix}e^{6x} + \begin{bmatrix} 8b+d \\ -4b+4d \end{bmatrix}xe^{6x}.$$
    Solving the system, we have $$a=-\frac{m+2n}{4}~b=-\frac{m}{2}~c=n~d=m$$
    for $m,n \in \RR$. Letting $n=1$ and $m=-2$, we get $a=0, b=1, c=1, d=-2$.
    Therefore, $$y_2 = \alpha_2 \begin{bmatrix} x \\ 1-2x \end{bmatrix}e^{6x}.$$
    Solving for $\alpha_1$ and $\alpha_2$, we find
    $$y = -17\begin{bmatrix} -1 \\ 2 \end{bmatrix}e^{6x}+76\begin{bmatrix} x \\ 1-2x \end{bmatrix}e^{6x}
    \implies y = \begin{bmatrix}17 \\42\end{bmatrix}e^{6x}+76\begin{bmatrix} 1\\ -2 \end{bmatrix}xe^{6x}.$$
\end{example}
\begin{exercise}[Undetermined Coefficients]
    Solve the following sytem of differential equations:
    $$y' = \begin{bmatrix} 1 & 2 \\ -1 & 4 \end{bmatrix}y + \begin{bmatrix} 1+x\\e^x \end{bmatrix}.$$
\end{exercise}
\begin{soln}
    The homogeneous solution is $$y_h = \alpha_1 
    \begin{bmatrix} 2 \\ 1 \end{bmatrix} + \alpha_2 \begin{bmatrix} 1 \\ 1 \end{bmatrix}e^{3x}.$$
    The particular solution is 
    $$y_p = \begin{bmatrix} d_1 \\ d_2 \end{bmatrix}e^x + \begin{bmatrix} r_1 \\ r_2\end{bmatrix}x + 
    \begin{bmatrix} s_1 \\ s_2\end{bmatrix}.$$ Plugging into the original
    differential equation, we obtain
    \begin{align*}
        \begin{bmatrix} d_1 \\ d_2 \end{bmatrix}e^x + \begin{bmatrix} r_1 \\ r_2\end{bmatrix} &= 
        \begin{bmatrix} 1 & 2 \\ -1 & 4\end{bmatrix}\left(\begin{bmatrix} d_1 \\ d_2 \end{bmatrix}e^x + 
        \begin{bmatrix} r_1 \\ r_2\end{bmatrix}x + \begin{bmatrix} s_1 \\ s_2\end{bmatrix}\right)+
        \begin{bmatrix} 1+x \\ e^x \end{bmatrix} \\
        \begin{bmatrix} d_1 \\ d_2 \end{bmatrix}e^x + \begin{bmatrix} r_1 \\ r_2\end{bmatrix} &=
        \begin{bmatrix} d_1+d_2 \\ -d_1+4d_2+1\end{bmatrix}e^x +\begin{bmatrix} r_1+2r_2+1 \\ -r_1+4r_2 \end{bmatrix}x+
        \begin{bmatrix} s_1+2s_2+1 \\ -s_1+4s_2 \end{bmatrix}.
    \end{align*}
    Comparing coefficients, we find that 
    \begin{align*}
        d_1 &= 1 &d_2 &= 0 \\
        r_1 &=-2/3 &r_2 &= -1/6 \\
        s_1 &= 19/18 &s_2 &= -11/36
    \end{align*}
    Thus $$\boxed{y=\alpha_1\begin{bmatrix} 2 \\ 1 \end{bmatrix}e^x + \alpha_2 \begin{bmatrix} 1 \\ 1 \end{bmatrix}e^{3x}
    +\begin{bmatrix} 1 \\ 0 \end{bmatrix} e^x + \begin{bmatrix} -2/3 \\ -1/6 \end{bmatrix}x
+\begin{bmatrix} 19/18 \\ -11/36 \end{bmatrix}}.$$
\end{soln}

We now proceed to examine the method of variation of parameters in solving
systems of differentual equations. Suppose we have the following system:
$$y' = \mathbf{A}y + f.$$ Let the $y_1, y_2, \dots, y_n$ be the fundamental
        solutions of the system and $$\bold{Y} = \begin{bmatrix} y_1 & y_2 & \cdots & y_n \end{bmatrix}.$$
        Then we have $$y_p = \mathbf{Y}\int \mathbf{Y}^{-1}f \dif x.$$
\begin{example}[Variation of Parameters]
    Solve the following system of differential equations:
    $$y' = \begin{bmatrix} 1 & 3 \\ 3 & 1\end{bmatrix}y+\begin{bmatrix}3 \\ -3 \end{bmatrix}
    \sqrt{t}e^{-2t}.$$ Solving for the homogeneous portion, we have
    $$y_h = \alpha_1 \begin{bmatrix} 1 \\ 1 \end{bmatrix}e^{4x} + \alpha_2
    \begin{bmatrix} 1 \\ -1 \end{bmatrix}e^{-2x}.$$
    So, we let $$\mathbf{Y} = \begin{bmatrix} e^{4x} & e^{-2x} \\ e^{4x} & e^{-2x} \end{bmatrix}.$$
    The inverse of $\mathbf{Y}$ is
    $$\mathbf{Y}^{-1} = \frac{1}{-2e^{2x}} \begin{bmatrix} -e^{-2x} & -e^{-2x} \\ -e^{4x} & e^{4x}\end{bmatrix}
    = \frac{1}{2}\begin{bmatrix} e^{-4x} & e^{-4x} \\ e^{2x} & -e^{2x}\end{bmatrix}$$
    From this $$\mathbf{Y}^{-1}f = \begin{bmatrix} 0 \\ 3\sqrt{t}\end{bmatrix}.$$
    Thus,
    \begin{align*}
        \int \mathbf{Y}^{-1} f \dif t = \int \begin{bmatrix} 0 \\ 3\sqrt{t}\end{bmatrix} \dif t
                                      = \begin{bmatrix} 0 \\ 2t^{3/2}\end{bmatrix}.
    \end{align*}
    So,
    $$\mathbf{Y}\int \mathbf{Y}^{-1} f \dif t = \begin{bmatrix} 2t^{3/2}e^{-2t} \\ -2t^{3/2}e^{-2t}\end{bmatrix}.$$
    Our general solution is therefore,
    $$y = \alpha_1 \begin{bmatrix} 1 \\ 1 \end{bmatrix}e^{4x} + \alpha_2
    \begin{bmatrix} 1 \\ -1 \end{bmatrix}e^{-2x}+\begin{bmatrix} 1 \\ -1\end{bmatrix}2t^{3/2}e^{-2t}.$$
\end{example}
\newpage
\section{Power Series Approach}
Sometimes an ordinary differential equation is not solvable using the standard
methods introduced thus far. Therefore, using a power series as a guess for the
general solution can be a powerful approach. To examine this, we take a look
at an example that may also be solved using a separation of variables.
%Some very common power series are:
%\begin{align*}
%    e^x &= \sum_{n \geq 0} \frac{x^n}{n!} \\
%    \sin x &= \sum_{n \geq 0} (-1)^n \frac{x^{2n+1}}{(2n+1)!} \\
%    \cos x &= \sum_{n \geq 0} (-1)^n \frac{x^{2n}}{(2n)!} \\
%    \sum_{n \geq 0} x^n &= \frac{1}{1-x}
%\end{align*}
\begin{example}[Power Series]
    Solve for $y$: $$(x-3)y' + 2y = 0.$$
\end{example}
\begin{soln}
    The guess we make for the general solution of $y$ is
    $$y = a_0 x^0 + a_1 x^1 + a_2 x^2 +\cdots = \sum_{n = 0}^{\infty} a_n x^n.$$
    Taking the derivative of this, we get
    $$y' = a_1+2a_2x + 3a_3x^2 + \cdots = \sum_{n = 1}^{\infty} a_n n x^{n-1}.$$
    Plugging in this into our differential equation, we obtain
    \begin{align*}
        (x-3)\sum_{n = 1}^{\infty} a_n n x^{n-1} + 2\sum_{n = 1}^{\infty} a_n x^n &= 0 \\
        x\sum_{n = 1}^{\infty} a_n n x^{n-1} - 3\sum_{n = 1}^{\infty} a_n n x^{n-1}+2\sum_{n = 0}^{\infty} a_n x^n &= 0 \\
        \sum_{n = 1}^{\infty} a_n n x^{n} - 3\sum_{n = 1}^{\infty} a_n n x^{n-1}+2\sum_{n = 0}^{\infty} a_n x^n & =0
    \end{align*}
    Now, we seek to obtain the same exponent on $x$ for each summation so that
    it becomes easier to combine each sum. Therefore, we perform a \alert{change of
    indices} on the middle term, letting $n \rightarrow n+1$. This gives
    \begin{align*}
        \sum_{n = 1}^{\infty} a_n n x^{n} - 3\sum_{n = 0}^{\infty} a_{n+1} (n+1)x^{n}+2\sum_{n = 0}^{\infty} a_n x^n &= 0\\
        \sum_{n = 1}^{\infty} a_n n x^{n} + \sum_{n = 0}^{\infty} \left(2a_n-3a_{n+1}(n+1)\right)x^n &= 0 \\
        \sum_{n = 1}^{\infty} a_n n x^{n} + \sum_{n = 1}^{\infty} \left(2a_n-3a_{n+1}(n+1)\right)x^n &= 3a_1-2a_0 \\
        \sum_{n = 1}^{\infty}\left((n+2)a_n-3a_{n+1}(n+1)\right)x^n &= 3a_1 - 2a_0.
    \end{align*}
    Comparing coefficients gives $2a_0-3a_1 = 0$ and $(n+2)a_n-3a_{n+1}(n+1) = 0$ for all
    $n \geq 1$. Thus, we have the following recursion $$a_{n+1} = \frac{(n+2)a_n}{3(n+1)},$$
    where $a_1 = (2/3)a_0$. We try now to find a closed form for $a_n$. This
    is usually done by finding a pattern among the terms. Thus, listing out
    the first few therms, we have
    \begin{center}
        \begin{tabular}{| c | c |}
            \hline
            $n$ & $a_n$ \\
            \hline
            $0$ & $a_0$ \\
            $1$ & $(2/3)a_0$ \\
            $2$ & hi \\
            $3$ & hi \\
            $4$ & hi \\
            $5$ & hi \\
            \hline
        \end{tabular}
    \end{center}
    \begin{align*}
        a_1 &= \frac{2}{3}a_0 \\
        a_2 &= \frac{1}{3}a_0 \\
        a_3 &= \frac{4}{3^3}a_0 \\
        a_4 &= \frac{5}{3^4}a_0 \\
        a_5 &= \frac{6}{3^5}a_0.
    \end{align*}
    Therefore, the closed form is most likely $$a_n = \frac{n+1}{3^n}a_0.$$ So,
    we have 
    \begin{align*}
        y &= a_0\sum_{n \geq 0} \frac{n+1}{3^n} x^n \\
        &= a_0 \sum_{n \geq 0} n \left(\frac{x}{3} \right)^n + a_0\sum_{n\geq 0} \left(\frac{x}{3}\right)^n \\
        &= a_0 \left(\frac{x/3}{(1-(x/3))^2}+\frac{1}{1-(x/3)} \right) \\
        &=\frac{a_0}{(1-(x/3))^2}.
    \end{align*}
\end{soln}
\begin{theorem}[Frobenius Method]
    In the case we are faced with the differential equation
    $$y'' + p(x)y' + q(x)y = 0,$$ where $p(x)$ and $q(x)$ are of the
    from $b(x)/x$ and $c(x)/x^2)$, respectively, the initial guess for $y$
    is $$x^r \sum_{n \geq 0} a_n x^n.$$ The value of $r$ is determined by the
    indicial equation $r(r-1)+rb_0 + c_0 = 0$. For the multuple $r$ values
    found, use the bigger value of $r$. This method produces one fundamental
    solution. The other solution is found with a reduction of order, where
    $y_2=u(x)y_1(x)$ such that 
    $$u'(x) = \frac{1}{y^2}e^{-\int p(x) \dif x}.$$
\end{theorem}
\begin{example}
    We desire to solve the following differential equation
    $$xy''+2y'+4xy = 0.$$ Re-expressing the differentual equation, we have
    $$y'' + \frac{2}{x}y' + \frac{4x^2}{x^2}y = 0.$$
\end{example}
%\section{SIR Epidemic Model}
%An illustrative example of a system of differential equations is modeling an
%epidemic taking into account the susceptable population, infected population, and
%recovered population.\
